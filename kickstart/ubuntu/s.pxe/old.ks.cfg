#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T
# https://bugs.launchpad.net/ubuntu/+source/kickseed/+bug/420903/+viewstatus

#System timezone, language, modules, keyboard, mouse
timezone America/New_York
lang en_US
langsupport en_US
keyboard us
mouse

#Root password
auth  --useshadow  --enablemd5
rootpw --disabled
user msalisbury --fullname "Michael Salisbury" --iscrypted $1$BBtB2HFR$IgUrgjqXCjo5Jl8ANB87F.
#Reboot after installation

#Instalation: Modes [text,graphical] [interactive,autostep] [install,upgrade] [halt,reboot]
graphical
interactive
install
reboot
#Run the Setup Agent on first boot
firstboot --enable


#Instalation source
url --url http://archive.ubuntu.com/ubuntu
#url --url http://10.173.119.78/OS/Ubuntu/11.10x86_64a

#Hard Drive Setup
bootloader --location=mbr
zerombr yes
clearpart --all --initlabel
part swap --recommended
part / --fstype ext3 --size 1 --grow


#Network
network --bootproto=dhcp --device=eth0 --hostname=rename-me.pig.pie
firewall --disabled


#Desktop: X Window System configuration information
xconfig --depth=32 --defaultdesktop=GNOME --startxonboot


# NTP
preseed clock-setup/ntp boolean true
preseed clock-setup/ntp-server string ntp.myfloridacity.us


# Pre Install Config
%pre
#preseed --owner d-i apt-setup/security_host string security.ubuntu.com
#preseed --owner netcfg netcfg/dhcp_timeout string 60

# perform unattended package upgrades
#preseed d-i pkgsel/update-policy select unattended-upgrades

# attempt a retry if the apt-cacher mirror fails for some reason
#preseed d-i apt-setup/mirror/error select Retry

# repos:
#preseed --owner d-i apt-setup/universe boolean true
#preseed --owner d-i apt-setup/multiverse boolean true
#preseed --owner d-i apt-setup/non-free boolean true
#preseed --owner d-i apt-setup/local0/repository string deb http://archive.canonical.com/ubuntu maverick partner
#preseed --owner d-i apt-setup/local0/repository string deb-src http://archive.canonical.com/ubuntu maverick partner

#preseed --owner d-i apt-setup/local0/repository string deb http://download.virtualbox.org/virtualbox/debian maverick contrib
#preseed --owner d-i apt-setup/local0/repository string deb-src http://download.virtualbox.org/virtualbox/debian maverick contrib
#preseed --owner d-i apt-setup/local0/repository string deb http://x2go.obviously-nice.de/deb/ lenny main
#preseed --owner d-i apt-setup/local0/repository string deb-src http://x2go.obviously-nice.de/deb/ lenny main

#Package install information
%packages --resolvedeps
#@ standard
#@ base
#@ core
#@ ubuntu-standard
#@ kubuntu-desktop
#@ edubuntu-desktop
#@ dns-server
#@ lamp-server
@ ubuntu-desktop
gnome-panel
vim
openssh-server
gnome-rdp

# Post Install Script
%post
# enable useful repositories
preseed --owner d-i apt-setup/universe boolean true
preseed --owner d-i apt-setup/multiverse boolean true
preseed --owner d-i apt-setup/non-free boolean true

# Auto-accept licenses for Java and VMware
preseed --owner sun-java6-jdk shared/accepted-sun-dlj-v1-1 boolean true
preseed --owner sun-java6-jre shared/accepted-sun-dlj-v1-1 boolean true
preseed --owner vmware-player shared/accepted-vmware-player-v1-0-2 boolean true

# Gather post install scripts and tools
mkdir      /root/post-install-scripts
wget -q -O /root/post-install-scripts/runonce-11.10.sh http://192.168.248.24/kickstart/runonce-11.10.sh
chmod +x   /root/post-install-scripts/runonce-11.10.sh

# Fix /etc/apt/sources.list
#sed -i 's|10.173.119.78/OS/Ubuntu/11.10x86_64a|us.archive.ubuntu.com/ubuntu|' /etc/apt/sources.list

#-------------------------------------------------------------------------------------/root/testing
cat<<EOF>>/root/testing
Hello World!
I am the master
EOF

#-------------------------------------------------------------------------------------/etc/rc.local
sed -i '/^exit 0$/d' /etc/rc.local
cat<<END-OF-RC.LOCAL>>/etc/rc.local
/root/post-install-scripts/runonce-11.10.sh >> /var/log/runonce-11.10.sh 2>&1 &
exit 0
END-OF-RC.LOCAL

#-------------------------------------------------------------------------------------
        mkdir /home/msalisbury/.ssh
cat << EOF >> /home/msalisbury/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAofjHmUuZrNEsTUSx/Agb5bJOGP57DvbLxAh9xsBniAvyA7I3X68TAJZixWKQEs4SbhNhkO5wcZwC/9k/j2GXpvKEFewscxlw9X1/Mcxcpndl94Yptei2klBb5WKNSFJ06GxkxM/AtfXK6IQtKr/qiQfg/pdvwQ/X51kKFp8DQdiaUz5GgEqh19y6+uCfqGJsOkNph/9cGJGeJxRxJjuwghI3fmb9QapxLSqcQBJ++0GDo4UyO5smJgBiyL96g3sOzB4H/UMGdnQqsemLGvRmu60Jmy15D0I1XDfcN29kYOfoxYzkpbxvp3P9F/BL/Yao/J3x1Cz1U17GqRduTgnwrQ== root@RHEL01.localdomain
ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAIEAmMckh4/gd/8LK4wpmhdcnSEzLuDR+aiNojMI5j3enNRiJ4Kml4+JxlwllosZW2soz8i6THVEzp24d39XrfrXmopXQaUr+D41ES0WDbq0ZNu2hxLVxwLFimbo7xdRKs5+e8VuBBbH7gIvGYdmUGWEN8972S2UJpJnupgw4WaOg8U= rsa-key-20110617
EOF
        chown -R msalisbury.msalisbury /home/msalisbury/.ssh
        chmod 700                      /home/msalisbury/.ssh
        chmod 644                      /home/msalisbury/.ssh/*

        mkdir /root/.ssh
cat << EOF >> /root/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAofjHmUuZrNEsTUSx/Agb5bJOGP57DvbLxAh9xsBniAvyA7I3X68TAJZixWKQEs4SbhNhkO5wcZwC/9k/j2GXpvKEFewscxlw9X1/Mcxcpndl94Yptei2klBb5WKNSFJ06GxkxM/AtfXK6IQtKr/qiQfg/pdvwQ/X51kKFp8DQdiaUz5GgEqh19y6+uCfqGJsOkNph/9cGJGeJxRxJjuwghI3fmb9QapxLSqcQBJ++0GDo4UyO5smJgBiyL96g3sOzB4H/UMGdnQqsemLGvRmu60Jmy15D0I1XDfcN29kYOfoxYzkpbxvp3P9F/BL/Yao/J3x1Cz1U17GqRduTgnwrQ== root@RHEL01.localdomain
ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAIEAmMckh4/gd/8LK4wpmhdcnSEzLuDR+aiNojMI5j3enNRiJ4Kml4+JxlwllosZW2soz8i6THVEzp24d39XrfrXmopXQaUr+D41ES0WDbq0ZNu2hxLVxwLFimbo7xdRKs5+e8VuBBbH7gIvGYdmUGWEN8972S2UJpJnupgw4WaOg8U= rsa-key-20110617
EOF
        chown -R root.root /root/.ssh
        chmod 700          /root/.ssh
        chmod 644          /root/.ssh/*

